# Epidemic data

::: {.callout-note appearance="simple"}
This is a work in progress that is currently undergoing heavy technical editing and copy-editing
:::

## Introduction

One cannot study epidemic progress in time or spread in space without data collected in the field. The study of plant disease quantification is known as Phytopathometry, a well-established branch of plant pathology tasked with the science of disease measurement, but which has strong roots in epidemiology [@bock2021]. Historically, disease quantification has been performed visually, but advances in both imaging and remote sensing technologies have directly impacted the field during the last several decades. Therefore, the quantity of disease can be obtained via estimation (visually by human eye) or measurement (sensor or digital technologies).

While measuring disease is an objective task, visual assessment is largely subjective and as such known to vary among individuals. This occurs because humans have different inherent abilities, vary in training to assess disease, or are more or less affected by the chosen method (e.g. scales). Disease is estimated or measured on a specimen in a population, or on a sample of specimens drawn from a population. The specimen can be a plant organ, an individual plant, a group of plants, a field or a farm, and these also dictate how terms are defined to refer to disease quantity.

## Terminology

A general term used to refer to the quantity of disease expressed by any means is **disease intensity**. This actually has little practical value as it only suggest that the disease is more or less "intense", but there is no scale for intensity. We need more specific terms to refer to disease intensity.

When assessing disease, a primary task is to classify each specimen in a sample as diseased or not diseased. This binary (yes/no) assessment may be sufficient to express disease intensity in certain cases. For example, if the goal is to assess the number or proportion of diseased specimens in a sample or a population of specimens. The scenario leads to two important terms: disease **incidence** and **prevalence**. While incidence is commonly used to refer to the proportion or number of plants or their organs as the observational units, prevalence is used when referring to the proportion or number of fields or farms with diseased plants in a large production area or region [@nutter2006]. Hence, prevalence is equivalent to incidence, only differing in the spatial scale of the sampling unit.

In many cases we need to ascertain the *degree to which a specimen is diseased*, which is a definition of disease **severity**. Elsewhere, severity is defined restrictively as the proportion of the unit that is symptomatic [@nutter2006], but a revised concept of disease severity encompasses other metrics including lesion counts and scores based on ordinal scales. These latter scales can be further divided into classes defined based on either the percentage scale or descriptions of symptoms [@bock2021]. In some studies we may want to express the quantity of disease in terms of (average) lesion size or area. This can be considered a measure of severity, and it is typically used to classify host genotypes according to resistance or pathogen isolates according to their aggressiveness, influenced or not by environmental factors.

## Data types and distributions

The disease data used to express disease as incidence or any kind of severity measures vary in their nature as they can be discrete (countable) or continuous. They can also be described by a statistical distribution, which gives the probability that a particular value (or a range of values) will be drawn from a distribution. Knowledge about statistical or mathematical distributions constitute an important step to improve our understanding of data-collection methods, designs of experiments and data analysis such as data summarization or hypothesis testing.

### Binomial distribution

For incidence (and prevalence), the data is binary at the individual level, as there are only two possible outcomes in a *trial*: the plant or plant part is disease or not diseased. The statistical distribution that best describe the incidence data at the individual level is the *binomial distribution*.

Let's simulate the binomial outcomes for a range of probabilities in a sample of 100 units, using the `rbinom` function in R. For a single trial (e.g. status of plants in a single plant row), the `size` argument is set to 1.

```{r, warning=FALSE, message=FALSE}

library(tidyverse)
set.seed(123) # for reproducibility
P.1 <- rbinom(100, size = 1, prob = 0.1)
P.3 <- rbinom(100, size = 1, prob = 0.3)
P.7 <- rbinom(100, size = 1, prob = 0.7)
P.9 <- rbinom(100, size = 1, prob = 0.9)
binomial_data <- data.frame(P.1, P.3, P.7, P.9)
```

We can then visualize the plots.

```{r}
binomial_data |>
  pivot_longer(1:4, names_to = "P", 
               values_to = "value") |> 
  ggplot(aes(value))+
  geom_histogram(fill = "MediumSeaGreen", 
                 bins =10)+
  facet_wrap(~P)+
  theme_minimal()+
  labs(title = "Binomial distribution to describe binary data")
```

### Beta distribution

Disease incidence (or prevalence) at the sample or population level can be expressed as proportion of diseased individuals. The same applies to disease severity when expressed as proportion of the organ area affected (a ratio variable). For such cases, the beta distribution, which is bounded between 0 and 1, provides a good description. Let's simulate some data using the `rbeta` function.

```{r}
beta1.5 <- rbeta(n = 1000, shape1 = 1, shape2 = 5)
beta5.5 <- rbeta(n = 1000, shape1 = 5, shape2 = 5)
beta_data <- data.frame(beta1.5, beta5.5)

```

Notice there are two shape parameters in the beta distribution: `shape1` and `shape2` to be defined. This makes the distribution very flexible and with several potential shapes as we can see below.

```{r, warning=FALSE}
beta_data |>
  pivot_longer(1:2, names_to = "P", 
               values_to = "value") |> 
  ggplot(aes(value))+
  geom_histogram(fill = "MediumSeaGreen", 
                 color = "white", 
                 bins = 15)+
  scale_x_continuous(limits = c(0,1))+
  facet_wrap(~P)+
  theme_minimal()+
  labs(title = "Beta distribution to describe proportion data")
```

### Poisson distribution

Count data

### Gamma distribution

Lesion size data
