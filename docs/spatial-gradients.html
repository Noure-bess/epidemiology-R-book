<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 3 Spatial gradients | R4PDE</title>
<meta name="author" content="Emerson M. Del Ponte">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.9/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.5.1/tabs.js"></script><script src="libs/bs3compat-0.2.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS -->
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">R4PDE</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Welcome</a></li>
<li><a class="" href="temporal-analysis.html"><span class="header-section-number">2</span> Temporal analysis</a></li>
<li><a class="active" href="spatial-gradients.html"><span class="header-section-number">3</span> Spatial gradients</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="spatial-gradients" class="section level1" number="3">
<h1>
<span class="header-section-number">3</span> Spatial gradients<a class="anchor" aria-label="anchor" href="#spatial-gradients"><i class="fas fa-link"></i></a>
</h1>
<div id="models" class="section level2" number="3.1">
<h2>
<span class="header-section-number">3.1</span> Models<a class="anchor" aria-label="anchor" href="#models"><i class="fas fa-link"></i></a>
</h2>
<p>When modeling disease gradients, the distance is represented by <span class="math inline">\(x\)</span> , a continuous variable which can be expressed by various units (cm, m, km, etc). The gradient models, similar to the population dynamics models (disease progress) are of the <strong>deterministic</strong> type. The difference is that, for disease progress curves, disease intensity tends to increase with increasing time, while in disease gradients the disease intensity tends to decrease with increasing distance from the source of inoculum. Two models are most commonly fitted to data on disease gradients. More details about these models can be obtained it <a href="https://www.apsnet.org/edcenter/disimpactmngmnt/topc/EcologyAndEpidemiologyInR/ModelingDispersalGradients/Pages/default.aspx">this tutorial.</a></p>
<div id="exponential-model" class="section level3" number="3.1.1">
<h3>
<span class="header-section-number">3.1.1</span> Exponential model<a class="anchor" aria-label="anchor" href="#exponential-model"><i class="fas fa-link"></i></a>
</h3>
<p>The exponential model is also known as Kiyosawa &amp; Shiyomi model. The differential of the exponential model is given by</p>
<p><span class="math inline">\(\frac{dy}{dx}\)</span> = <span class="math inline">\(-b_{E}.y\)</span> ,</p>
<p>where <span class="math inline">\(b_{E}\)</span> is the exponential form of the rate of decline and <span class="math inline">\(y\)</span> is the disease intensity. This model suggests that <span class="math inline">\(y\)</span> (any disease intensity) is greater close to the source of inoculum, or at the distance zero. The integral form of the model is given by</p>
<p><span class="math inline">\(y = a . e^{-b.x}\)</span> ,</p>
<p>where <span class="math inline">\(a\)</span> is the disease intensity at the distance zero and <span class="math inline">\(b\)</span> is the rate of decline, in this case negative because disease intensity decreases with the increase of the distance from inoculum source. Let’s make a plot for two disease gradients of varying parameters for this model.</p>
<p>First we need to load essential packages for programming, customizing the outputs and defining a global ggplot theme.</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jrnold/ggthemes">ggthemes</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span>
<span class="fu">theme_set</span><span class="op">(</span><span class="fu">theme_light</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="fu">knitr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/knitr/man/opts_chunk.html">opts_chunk</a></span><span class="op">$</span><span class="fu">set</span><span class="op">(</span>echo <span class="op">=</span> <span class="cn">TRUE</span>, warning <span class="op">=</span> <span class="cn">FALSE</span>, message <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p>Set the parameters for the exponential model with two rates and same inoculum at the source:</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">a1</span> <span class="op">&lt;-</span> <span class="fl">0.2</span> <span class="co"># y at distance zero for gradient 1</span>
<span class="va">a2</span> <span class="op">&lt;-</span> <span class="fl">0.2</span> <span class="co"># y at distance zero for gradient 2</span>
<span class="va">b1</span> <span class="op">&lt;-</span> <span class="fl">0.1</span> <span class="co"># decline rate for gradient 1</span>
<span class="va">b2</span> <span class="op">&lt;-</span> <span class="fl">0.05</span> <span class="co"># decline rate for gradient 2</span>
<span class="va">max1</span> <span class="op">&lt;-</span> <span class="fl">80</span> <span class="co"># maximum distance for gradient 1</span>
<span class="va">max2</span> <span class="op">&lt;-</span> <span class="fl">80</span> <span class="co"># maximum distance for gradient 2</span>
<span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">max1</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="va">a1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>The following code allows to visualize the model predictions.</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">stat_function</span><span class="op">(</span>fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">a1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">b1</span> <span class="op">*</span> <span class="va">x</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">stat_function</span><span class="op">(</span>fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">a2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">b2</span> <span class="op">*</span> <span class="va">x</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">ylim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">a1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">annotate</span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">20</span>, y <span class="op">=</span> <span class="fl">0.04</span>, label <span class="op">=</span> <span class="st">"b = 0.1"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">annotate</span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">20</span>, y <span class="op">=</span> <span class="fl">0.10</span>, label <span class="op">=</span> <span class="st">"b = 0.05"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>
    title <span class="op">=</span> <span class="st">"Exponential model"</span>,
    subtitle <span class="op">=</span> <span class="st">""</span>,
    x <span class="op">=</span> <span class="st">"Distance (m)"</span>,
    y <span class="op">=</span> <span class="st">"Disease incidence (proportion)"</span>
  <span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="livro_files/figure-html/unnamed-chunk-39-1.png" width="672"></div>
</div>
<div id="power-law-model" class="section level3" number="3.1.2">
<h3>
<span class="header-section-number">3.1.2</span> Power law model<a class="anchor" aria-label="anchor" href="#power-law-model"><i class="fas fa-link"></i></a>
</h3>
<p>Also known as the modified Gregory’s model (Gregory was a pioneer in the use this model to describe plant disease gradients). In the power law model, <span class="math inline">\(Y\)</span> is proportional to the power of the distance, and is given by:</p>
<p><span class="math inline">\(Y = a_{P}.x - b_{P}\)</span></p>
<p>where <span class="math inline">\(a_{P}\)</span> and <span class="math inline">\(b_{P}\)</span> are the two parameters of the power law model. They differ from the exponential because as closer to <span class="math inline">\(x\)</span> is to zero, <span class="math inline">\(Y\)</span> is indefinitely large (not meaningful biologically). However, the model can still be useful because it produces realistic values at any distance <span class="math inline">\(x\)</span> away from the source. The values of the <span class="math inline">\(a_{P}\)</span> parameter should be interpreted in accord to the scale of <span class="math inline">\(x\)</span>, whether in centimeters or meters. If the distance between the source and the first measure away from the source is 0.5m, it is so more appropriate to record the distance in cm than in m or km.</p>
<p>Once <span class="math inline">\(y\)</span> at the distance zero from the source is undefined when using the power law model, this is usually modified by the addition of a positive constant <span class="math inline">\(C\)</span> in <span class="math inline">\(x\)</span>:</p>
<p><span class="math inline">\(Y = a_{P}.(x + C) - b_{P}\)</span></p>
<p>For this reason, the model is named as the modified power law. Here the constant <span class="math inline">\(C\)</span> is of the same unit of <span class="math inline">\(x\)</span>. At the distance zero, the positive constant is a term that express the size of the inoculum source. In other words, the <span class="math inline">\(a\)</span> parameter is a theoretical value of <span class="math inline">\(Y\)</span> at the distance <span class="math inline">\(1-C\)</span> from the center of the inoculum source.</p>
<p>Let’s plot two gradients with two rate parameters for the modified power law model:</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">C</span> <span class="op">&lt;-</span> <span class="fl">0.5</span>
<span class="va">a1</span> <span class="op">&lt;-</span> <span class="fl">0.2</span> <span class="co"># y at zero distance for gradient 1</span>
<span class="va">a2</span> <span class="op">&lt;-</span> <span class="fl">0.2</span> <span class="co"># y at zero distance for gradient 2</span>
<span class="va">b1</span> <span class="op">&lt;-</span> <span class="fl">0.5</span> <span class="co"># decline rate for gradient 1</span>
<span class="va">b2</span> <span class="op">&lt;-</span> <span class="fl">0.7</span> <span class="co"># decline rate for gradient 2</span>
<span class="va">max1</span> <span class="op">&lt;-</span> <span class="fl">80</span> <span class="co"># maximum distance for gradient 1</span>
<span class="va">max2</span> <span class="op">&lt;-</span> <span class="fl">80</span> <span class="co"># maximum distance for gradient 2</span>
<span class="va">dat2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">max1</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="va">a1</span><span class="op">)</span><span class="op">)</span>


<span class="va">dat2</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">stat_function</span><span class="op">(</span>fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">a1</span> <span class="op">*</span> <span class="op">(</span><span class="op">(</span><span class="va">x</span> <span class="op">+</span> <span class="va">C</span><span class="op">)</span><span class="op">^</span><span class="op">-</span><span class="va">b1</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">stat_function</span><span class="op">(</span>fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">a2</span> <span class="op">*</span> <span class="op">(</span><span class="op">(</span><span class="va">x</span> <span class="op">+</span> <span class="va">C</span><span class="op">)</span><span class="op">^</span><span class="op">-</span><span class="va">b2</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">ylim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">a1</span> <span class="op">-</span> <span class="fl">0.02</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">annotate</span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">20</span>, y <span class="op">=</span> <span class="fl">0.03</span>, label <span class="op">=</span> <span class="st">"b = 0.1"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">annotate</span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">20</span>, y <span class="op">=</span> <span class="fl">0.06</span>, label <span class="op">=</span> <span class="st">"b = 0.05"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>
    title <span class="op">=</span> <span class="st">"Modified Power Law"</span>,
    subtitle <span class="op">=</span> <span class="st">""</span>,
    x <span class="op">=</span> <span class="st">"Distance (m)"</span>,
    y <span class="op">=</span> <span class="st">"Disease incidence"</span>
  <span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="livro_files/figure-html/unnamed-chunk-40-1.png" width="672"></div>
<p>&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD:spatial-gradient.Rmd
The differential equation of the modified power law model is given by:
=======</p>
<p>The differential equation of the power law model is given by:
&gt;&gt;&gt;&gt;&gt;&gt;&gt; parent of 255e368 (big change to distill website!):02-spatial-gradients.Rmd</p>
<p><span class="math inline">\(\frac{dy}{dx}\)</span> = <span class="math inline">\(\frac{-b_{P}.Y}{x - C}\)</span></p>
<p>Similar to the exponential model, <span class="math inline">\(\frac{dy}{dx}\)</span> is proportional to <span class="math inline">\(Y\)</span>, meaning that the gradient is steeper (more negative) at the highest disease intensity value, usually closer to the source.</p>
</div>
</div>
<div id="linearization-of-the-models" class="section level2" number="3.2">
<h2>
<span class="header-section-number">3.2</span> Linearization of the models<a class="anchor" aria-label="anchor" href="#linearization-of-the-models"><i class="fas fa-link"></i></a>
</h2>
<div id="transformations-of-y" class="section level3" number="3.2.1">
<h3>
<span class="header-section-number">3.2.1</span> Transformations of y<a class="anchor" aria-label="anchor" href="#transformations-of-y"><i class="fas fa-link"></i></a>
</h3>
<p>The gradient models, again similar to the temporal disease models, are <strong>non linear in their parameters</strong>. The model is intrinsically linear if transformations are applied (according to the model) in both sides of the equations. The linear model in its generic state is given by</p>
<p><span class="math inline">\(y* = a* + bx\)</span> ,</p>
<p>where the asterisk in <span class="math inline">\(a\)</span> indicated that one of the transformations was applied in <span class="math inline">\(y\)</span> that produced the linear model. Note that <span class="math inline">\(a*\)</span> is the transformed version of the initial disease intensity, which needs to be returned to the original scale according to the respective back-transformation. Follows the linearized form of the two most common gradient models.</p>
<p><span class="math inline">\(ln(y) = ln(a_{E}) - b_{E}. x\)</span></p>
<p><span class="math inline">\(ln(y) = ln(a_{P}) - b_{E}. ln(x+C)\)</span></p>
</div>
<div id="plot-for-the-linearized-form-of-models" class="section level3" number="3.2.2">
<h3>
<span class="header-section-number">3.2.2</span> Plot for the linearized form of models<a class="anchor" aria-label="anchor" href="#plot-for-the-linearized-form-of-models"><i class="fas fa-link"></i></a>
</h3>
<p>&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD:spatial-gradient.Rmd
Let’s visualize the linearization of the exponential model with two different slopes (gradient 1 and 2). Note that the transformation used was <span class="math inline">\(ln(y)\)</span>.
=======
Let’s visualize the linearization of the exponential model with two different slopes (gradient 1 and 2). Note que the transformation used was <span class="math inline">\(ln(y)\)</span>.</p>
<p>Follows the linearization of the modified power law model.
&gt;&gt;&gt;&gt;&gt;&gt;&gt; parent of 255e368 (big change to distill website!):02-spatial-gradients.Rmd</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">C</span> <span class="op">&lt;-</span> <span class="fl">0.5</span>
<span class="va">a1</span> <span class="op">&lt;-</span> <span class="fl">0.2</span> <span class="co"># y at zero distance for gradient 1</span>
<span class="va">a2</span> <span class="op">&lt;-</span> <span class="fl">0.2</span> <span class="co"># y at zero distance for gradient 2</span>
<span class="va">b1</span> <span class="op">&lt;-</span> <span class="fl">0.5</span> <span class="co"># decline rate for gradient 1</span>
<span class="va">b2</span> <span class="op">&lt;-</span> <span class="fl">0.7</span> <span class="co"># decline rate for gradient 2</span>
<span class="va">max1</span> <span class="op">&lt;-</span> <span class="fl">80</span> <span class="co"># maximum distance for gradient 1</span>
<span class="va">max2</span> <span class="op">&lt;-</span> <span class="fl">80</span> <span class="co"># maximum distance for gradient 2</span>
<span class="va">dat2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">max1</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="va">a1</span><span class="op">)</span><span class="op">)</span>

<span class="va">dat2</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">stat_function</span><span class="op">(</span>fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">a1</span><span class="op">)</span> <span class="op">-</span> <span class="op">(</span><span class="va">b1</span> <span class="op">*</span> <span class="va">x</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">stat_function</span><span class="op">(</span>fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">a2</span><span class="op">)</span> <span class="op">-</span> <span class="op">(</span><span class="va">b2</span> <span class="op">*</span> <span class="va">x</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>
    title <span class="op">=</span> <span class="st">"Exponential"</span>,
    subtitle <span class="op">=</span> <span class="st">""</span>,
    x <span class="op">=</span> <span class="st">"log of distance (m)"</span>,
    y <span class="op">=</span> <span class="st">"log of disease incidence"</span>
  <span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="livro_files/figure-html/unnamed-chunk-41-1.png" width="672"></div>
<p>Follows the linearization of the modified power law model. Note that the transformation used was <span class="math inline">\(ln(y)\)</span> and <span class="math inline">\(ln(x+C)\)</span> .</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">C</span> <span class="op">&lt;-</span> <span class="fl">0.5</span>
<span class="va">a1</span> <span class="op">&lt;-</span> <span class="fl">0.2</span> <span class="co"># y at zero distance for gradient 1</span>
<span class="va">a2</span> <span class="op">&lt;-</span> <span class="fl">0.2</span> <span class="co"># y at zero distance for gradient 2</span>
<span class="va">b1</span> <span class="op">&lt;-</span> <span class="fl">0.5</span> <span class="co"># decline rate for gradient 1</span>
<span class="va">b2</span> <span class="op">&lt;-</span> <span class="fl">0.7</span> <span class="co"># decline rate for gradient 2</span>
<span class="va">max1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="fl">80</span><span class="op">)</span> <span class="co"># maximum distance for gradient 1</span>
<span class="va">max2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="fl">80</span><span class="op">)</span> <span class="co"># maximum distance for gradient 2</span>
<span class="va">dat2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">max1</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="va">a1</span><span class="op">)</span><span class="op">)</span>

<span class="va">dat2</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">stat_function</span><span class="op">(</span>fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">a1</span><span class="op">)</span> <span class="op">-</span> <span class="op">(</span><span class="va">b1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">x</span> <span class="op">+</span> <span class="va">C</span><span class="op">)</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">stat_function</span><span class="op">(</span>fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">a2</span><span class="op">)</span> <span class="op">-</span> <span class="op">(</span><span class="va">b2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">x</span> <span class="op">+</span> <span class="va">C</span><span class="op">)</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>
    title <span class="op">=</span> <span class="st">"Modified Power Law"</span>,
    subtitle <span class="op">=</span> <span class="st">""</span>,
    x <span class="op">=</span> <span class="st">"log of distance (m)"</span>,
    y <span class="op">=</span> <span class="st">"log of disease incidence"</span>
  <span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="livro_files/figure-html/unnamed-chunk-42-1.png" width="672"></div>
</div>
</div>
<div id="model-fitting-2" class="section level2" number="3.3">
<h2>
<span class="header-section-number">3.3</span> Model fitting<a class="anchor" aria-label="anchor" href="#model-fitting-2"><i class="fas fa-link"></i></a>
</h2>
<div id="dataset" class="section level3" number="3.3.1">
<h3>
<span class="header-section-number">3.3.1</span> Dataset<a class="anchor" aria-label="anchor" href="#dataset"><i class="fas fa-link"></i></a>
</h3>
<p>The hypothetical data below shows a gradient for the number of lesions counted at varying distances in meters from the source. Let’s create two vectors, one for the distances <span class="math inline">\(x\)</span> and the other for the lesion count <span class="math inline">\(Y\)</span>, and then a dataframe by combining the two vectors.</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create the two vectors</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">1.6</span>, <span class="fl">2.4</span>, <span class="fl">3.2</span>, <span class="fl">4</span>, <span class="fl">7.2</span>, <span class="fl">12</span>, <span class="fl">15.2</span>, <span class="fl">21.6</span>, <span class="fl">28.8</span><span class="op">)</span>
<span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">184.9</span>, <span class="fl">113.3</span>, <span class="fl">113.3</span>, <span class="fl">64.1</span>, <span class="fl">25</span>, <span class="fl">8</span>, <span class="fl">4.3</span>, <span class="fl">2.5</span>, <span class="fl">1</span>, <span class="fl">0.8</span><span class="op">)</span>
<span class="va">grad1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">Y</span><span class="op">)</span> <span class="co"># create the dataframe</span>
<span class="va">grad1</span> <span class="co"># show the gradient</span></code></pre></div>
<pre><code>##       x     Y
## 1   0.8 184.9
## 2   1.6 113.3
## 3   2.4 113.3
## 4   3.2  64.1
## 5   4.0  25.0
## 6   7.2   8.0
## 7  12.0   4.3
## 8  15.2   2.5
## 9  21.6   1.0
## 10 28.8   0.8</code></pre>
</div>
<div id="visualize-the-gradient" class="section level3" number="3.3.2">
<h3>
<span class="header-section-number">3.3.2</span> Visualize the gradient<a class="anchor" aria-label="anchor" href="#visualize-the-gradient"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">grad1</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">x</span>, <span class="va">Y</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Lesion count"</span>,
       x <span class="op">=</span> <span class="st">"Distance (m)"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="livro_files/figure-html/unnamed-chunk-44-1.png" width="672"></div>
</div>
<div id="linear-regression-1" class="section level3" number="3.3.3">
<h3>
<span class="header-section-number">3.3.3</span> Linear regression<a class="anchor" aria-label="anchor" href="#linear-regression-1"><i class="fas fa-link"></i></a>
</h3>
<p>A linear regression model is fitted to the transformed variables according to the model. The higher the coefficient of determination, the better is the fit of the model to the data.</p>
<p>Exponential model</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">reg_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span> <span class="op">~</span> <span class="va">x</span>, data <span class="op">=</span> <span class="va">grad1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">reg_exp</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = log(Y) ~ x, data = grad1)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.0487 -0.5897 -0.0014  0.5957  0.9955 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   4.5771     0.3522   13.00  1.2e-06 ***
## x            -0.2012     0.0266   -7.58  6.4e-05 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.761 on 8 degrees of freedom
## Multiple R-squared:  0.878,  Adjusted R-squared:  0.862 
## F-statistic: 57.4 on 1 and 8 DF,  p-value: 6.45e-05</code></pre>
<p>Power law model with <span class="math inline">\(C = 0\)</span>.</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">reg_p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">grad1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">reg_p</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = log(Y) ~ log(x), data = grad1)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -0.7228 -0.1199 -0.0315  0.0876  0.6527 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)    5.564      0.246    22.7  1.5e-08 ***
## log(x)        -1.698      0.119   -14.3  5.7e-07 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.423 on 8 degrees of freedom
## Multiple R-squared:  0.962,  Adjusted R-squared:  0.957 
## F-statistic:  203 on 1 and 8 DF,  p-value: 5.71e-07</code></pre>
<p>Power law model with <span class="math inline">\(C = 0.4\)</span>.</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">reg_pm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">x</span> <span class="op">+</span> <span class="fl">0.4</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">grad1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">reg_pm</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = log(Y) ~ log(x + 0.4), data = grad1)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -0.5373 -0.1726 -0.0365  0.0845  0.5693 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)     6.101      0.228    26.7  4.1e-09 ***
## log(x + 0.4)   -1.884      0.108   -17.4  1.2e-07 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.349 on 8 degrees of freedom
## Multiple R-squared:  0.974,  Adjusted R-squared:  0.971 
## F-statistic:  302 on 1 and 8 DF,  p-value: 1.22e-07</code></pre>
<p>Graphs for the fitted models</p>
<p>Exponential</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">grad1</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_abline</span><span class="op">(</span>slope <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">reg_exp</span><span class="op">)</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, intercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">reg_exp</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">+</span>
 <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Log of Lesion count"</span>,
       x <span class="op">=</span> <span class="st">"Distance (m)"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="livro_files/figure-html/unnamed-chunk-48-1.png" width="672"></div>
<p>Power law model</p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">grad1</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_abline</span><span class="op">(</span>slope <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">reg_p</span><span class="op">)</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, intercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">reg_p</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">+</span>
 <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Log of Lesion count"</span>,
       x <span class="op">=</span> <span class="st">"Log of distance"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="livro_files/figure-html/unnamed-chunk-49-1.png" width="672"></div>
<p>Modified power law model</p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">grad1</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">x</span><span class="op">+</span><span class="fl">0.4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_abline</span><span class="op">(</span>slope <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">reg_pm</span><span class="op">)</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, intercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">reg_pm</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">+</span>
 <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Log of Lesion count"</span>,
       x <span class="op">=</span> <span class="st">"Log of distance (m)"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="livro_files/figure-html/unnamed-chunk-50-1.png" width="672"></div>
<p>Conclusion: The modified power law model provided the better fit.</p>

<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-chapter2017b" class="csl-entry">
Madden, Laurence V., Gareth Hughes, and Frank van den Bosch, eds. 2017. <span>“CHAPTER 4: Temporal Analysis i: Quantifying and Comparing Epidemics.”</span> In, 63–116. The American Phytopathological Society. <a href="https://doi.org/10.1094/9780890545058.004">https://doi.org/10.1094/9780890545058.004</a>.
</div>
</div>
</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="temporal-analysis.html"><span class="header-section-number">2</span> Temporal analysis</a></div>
<div class="empty"></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#spatial-gradients"><span class="header-section-number">3</span> Spatial gradients</a></li>
<li>
<a class="nav-link" href="#models"><span class="header-section-number">3.1</span> Models</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#exponential-model"><span class="header-section-number">3.1.1</span> Exponential model</a></li>
<li><a class="nav-link" href="#power-law-model"><span class="header-section-number">3.1.2</span> Power law model</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#linearization-of-the-models"><span class="header-section-number">3.2</span> Linearization of the models</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#transformations-of-y"><span class="header-section-number">3.2.1</span> Transformations of y</a></li>
<li><a class="nav-link" href="#plot-for-the-linearized-form-of-models"><span class="header-section-number">3.2.2</span> Plot for the linearized form of models</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#model-fitting-2"><span class="header-section-number">3.3</span> Model fitting</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#dataset"><span class="header-section-number">3.3.1</span> Dataset</a></li>
<li><a class="nav-link" href="#visualize-the-gradient"><span class="header-section-number">3.3.2</span> Visualize the gradient</a></li>
<li><a class="nav-link" href="#linear-regression-1"><span class="header-section-number">3.3.3</span> Linear regression</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>R4PDE</strong>" was written by Emerson M. Del Ponte. It was last built on 2021-07-13.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
