<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 4 Spatial patterns | R4PDE</title>
<meta name="author" content="Emerson M. Del Ponte">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.11/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS -->
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">R4PDE</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Welcome</a></li>
<li><a class="" href="temporal-analysis.html"><span class="header-section-number">2</span> Temporal analysis</a></li>
<li><a class="" href="spatial-gradients.html"><span class="header-section-number">3</span> Spatial gradients</a></li>
<li><a class="active" href="spatial-patterns.html"><span class="header-section-number">4</span> Spatial patterns</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="spatial-patterns" class="section level1" number="4">
<h1>
<span class="header-section-number">4</span> Spatial patterns<a class="anchor" aria-label="anchor" href="#spatial-patterns"><i class="fas fa-link"></i></a>
</h1>
<div id="introduction" class="section level2" number="4.1">
<h2>
<span class="header-section-number">4.1</span> Introduction<a class="anchor" aria-label="anchor" href="#introduction"><i class="fas fa-link"></i></a>
</h2>
<p>A spatial disease pattern can be defined as the arrangement of diseased entities relative to each other and to the architecture of the host crop <span class="citation">(<a href="spatial-patterns.html#ref-chapter2017" role="doc-biblioref">Madden, Hughes, and van den Bosch 2017b</a>)</span>. Such arrangement is the realization of the underlying dispersal of the pathogen, from one or several sources within and/or outside the area of interest, under the influence of physical, biological and environmental factors.</p>
<p>The study of spatial patterns is conducted at a specific time or multiple times during the epidemic. When assessed multiple times, both spatial and temporal processes can be characterized. Because epidemics change over time, it is expected that spatial patterns are not constant but change over time as well. Usually, plant pathologists are interested in determining spatial patterns at one or various spatial scales, depending on the objective of the study. The scale of interest may be a leaf or root, plant, field, municipality, state, country or even intercontinental area. The diseased units observed may vary from lesions on a single leaf to diseased fields in a large production region.</p>
<p>The patterns can be classified into two main types that occur naturally: <strong>random</strong> or <strong>aggregated</strong>. The random pattern originates because the chances for the units (leaf, plant, crop) to be infected are equal and low, and are largely independent from each other. In aggregated spatial patterns, such chances are unequal and there is dependency among the units, for example, a healthy unit close to a diseased unit is at higher risk than more distant units.</p>
<p>A range of techniques, most based on statistical tests, can be used to detect deviations from randomness in space and the choice of the methods depends on the scale of observation. Usually, more than one test is applied for the same or different scales of interest depending on how the data are collected. Three general categories of statistical tests can be determined based on the spatial scale and type of data collected: position of diseased units within a row or series of rows (plant to plant); quadrat or plot count data; or distance among the diseased units.</p>
</div>
<div id="position-and-status-within-a-row-plant-to-plant" class="section level2" number="4.2">
<h2>
<span class="header-section-number">4.2</span> Position and status within a row (plant to plant)<a class="anchor" aria-label="anchor" href="#position-and-status-within-a-row-plant-to-plant"><i class="fas fa-link"></i></a>
</h2>
<p>Here, the status of each unit (usually a plant) is noted as a nominal variable. The plant is either diseased (D or 1) or non-diseased or healthy (H or 0). These data are usually collected in a crop row, giving rise to a series of binary data.</p>
<div class="figure">
<img src="imgs/sp1.png" style="width:100.0%" alt=""><p class="caption">Representation of a series of units (plants) where the status is either diseased (D) or healthy (H)</p>
</div>
<p>Several statistical tests can be used to detect a deviation from randomness. The most commonly used tests are <strong>runs</strong>, <strong>doublets</strong> and <strong>joint count</strong> statistics.</p>
<div id="runs-test" class="section level3" number="4.2.1">
<h3>
<span class="header-section-number">4.2.1</span> Runs test<a class="anchor" aria-label="anchor" href="#runs-test"><i class="fas fa-link"></i></a>
</h3>
<p>The runs test. Description.</p>
<p>Let’s create a series of binary (0 = non-diseased; 1 = diseased) data representing a crop row with 20 plants, as shown in the Figure above.</p>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">y1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>
<span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span> <span class="co"># position of each plant</span>
<span class="va">z1</span> <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="va">row1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">y1</span>, <span class="va">z1</span><span class="op">)</span> <span class="co"># create a dataframe</span></code></pre></div>
<p>We can visualize it using ggplot.</p>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="va">row1</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">x1</span>, <span class="va">z1</span>, label <span class="op">=</span> <span class="va">x1</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">y1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span>shape <span class="op">=</span><span class="fl">15</span>, size <span class="op">=</span><span class="fl">6</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">theme_void</span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">z1</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">scale_color_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"green"</span>, <span class="st">"red"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_text</span><span class="op">(</span>vjust <span class="op">=</span> <span class="fl">0</span>, nudge_y <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">+</span>
<span class="fu">coord_fixed</span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">ylim</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span>,<span class="fl">2.5</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"right"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"Status"</span>, title <span class="op">=</span> <span class="st">"Sequence of diseased (1) or non-diseased (0) units (plants)"</span>, 
       subtitle <span class="op">=</span> <span class="st">"The numbers represent the position of the unit"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="livro_files/figure-html/unnamed-chunk-52-1.png" width="672"></div>
<p>We can write a code in R and create a function named <code>oruns.test</code>` for the ordinary runs test.</p>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">oruns.test</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span>
<span class="co"># identify the sequence</span>
<span class="va">S</span> <span class="op">&lt;-</span> <span class="va">x</span> 
<span class="co"># Compute the number or runs</span>
<span class="va">U</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span><span class="op">(</span><span class="va">S</span><span class="op">)</span><span class="op">!=</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co"># Compute the number of diseased plants</span>
<span class="va">m</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">S</span><span class="op">)</span>
<span class="co"># Count the total number of plants</span>
<span class="va">N</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">S</span><span class="op">)</span>
<span class="co"># Calculate the number of expected runs</span>
<span class="va">EU</span> <span class="op">=</span> <span class="fl">1</span> <span class="op">+</span> <span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">m</span><span class="op">*</span><span class="op">(</span><span class="va">N</span> <span class="op">-</span> <span class="va">m</span><span class="op">)</span><span class="op">/</span><span class="va">N</span><span class="op">)</span>
<span class="co"># Calculate the standard deviation in the sample</span>
<span class="va">sU</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">m</span> <span class="op">*</span> <span class="op">(</span><span class="va">N</span> <span class="op">-</span> <span class="va">m</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">m</span> <span class="op">*</span><span class="op">(</span><span class="va">N</span><span class="op">-</span><span class="va">m</span><span class="op">)</span><span class="op">-</span><span class="va">N</span><span class="op">)</span><span class="op">/</span> <span class="op">(</span><span class="va">N</span><span class="op">^</span><span class="fl">2</span> <span class="op">*</span><span class="op">(</span><span class="va">N</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co"># Calculate the z-value</span>
<span class="va">Z</span> <span class="op">=</span> <span class="op">(</span><span class="va">U</span> <span class="op">-</span> <span class="va">EU</span><span class="op">)</span><span class="op">/</span><span class="va">sU</span>
<span class="co"># Obtain the p-value for the Z</span>
<span class="va">pvalue</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">Z</span><span class="op">)</span>, lower.tail<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span>
<span class="co"># test if Z is lower than 1.64</span>
<span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">Z</span> <span class="op">&lt;</span> <span class="fl">1.64</span>, 
<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"clustering"</span><span class="op">)</span>, 
<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"randomness"</span><span class="op">)</span><span class="op">)</span>
<span class="co"># Print the results</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"There are"</span>,<span class="va">U</span>,<span class="st">"runs in the sequence. The number of expected runs is"</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">EU</span>,<span class="fl">1</span><span class="op">)</span>,<span class="st">"."</span>,
            <span class="st">"The value of Z is"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">Z</span>,<span class="fl">3</span><span class="op">)</span>, <span class="st">"indicating "</span>, <span class="va">result</span>,<span class="st">". P-value:"</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">pvalue</span>,<span class="fl">6</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>We can now run the test for the example series above.</p>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">oruns.test</span><span class="op">(</span><span class="va">row1</span><span class="op">$</span><span class="va">y1</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "There are 7 runs in the sequence. The number of expected runs is 10.6 . The value of Z is -1.727 indicating  clustering . P-value: 0.084166"</code></pre>
<p>There are built-in functions in R packages that allow for running the ordinary runs test. Let’s load the packages and runt the test. Note that the results of the <code>runs.test</code> is the same as the one produced by our custom function.</p>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">randtests</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/randtests/man/runs.test.html">runs.test</a></span><span class="op">(</span><span class="va">row1</span><span class="op">$</span><span class="va">y1</span>, threshold <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></code></pre></div>
<pre><code>## 
##  Runs Test
## 
## data:  row1$y1
## statistic = -2, runs = 7, n1 = 8, n2 = 12, n = 20, p-value = 0.08
## alternative hypothesis: nonrandomness</code></pre>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://andrisignorell.github.io/DescTools/">DescTools</a></span><span class="op">)</span>
<span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://andrisignorell.github.io/DescTools/reference/RunsTest.html">RunsTest</a></span><span class="op">(</span><span class="va">row1</span><span class="op">$</span><span class="va">y1</span><span class="op">)</span></code></pre></div>
</div>
<div id="doublets" class="section level3" number="4.2.2">
<h3>
<span class="header-section-number">4.2.2</span> Doublets<a class="anchor" aria-label="anchor" href="#doublets"><i class="fas fa-link"></i></a>
</h3>
<p>The doublets test. Description.</p>
<p>Let’s manually produce a code to execute the doublets test. To facilitate, we can create a function and name it <code>doublets.test</code>. The only argument needed is the vector of binary data.</p>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">doublets.test</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span>
<span class="co"># Identify the sequence</span>
<span class="va">S</span> <span class="op">&lt;-</span> <span class="va">x</span>
<span class="co"># Compute the number of doublets Db</span>
<span class="va">matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">S</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">S</span><span class="op">)</span><span class="op">]</span>, <span class="va">S</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>
<span class="va">pairs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">matrix</span><span class="op">)</span><span class="op">)</span>
<span class="va">Db</span> <span class="op">&lt;-</span> <span class="va">pairs</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span>
<span class="co"># Count the number of diseased plants</span>
<span class="va">N</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">S</span><span class="op">)</span> 
<span class="co"># Count the number of total plants</span>
<span class="va">d</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">S</span><span class="op">)</span> 
<span class="co"># </span>
<span class="va">NEDb</span> <span class="op">=</span> <span class="va">d</span> <span class="op">*</span><span class="op">(</span><span class="op">(</span><span class="va">d</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="va">N</span><span class="op">)</span>
<span class="va">DPDb</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span> <span class="op">(</span> <span class="va">NEDb</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="op">(</span><span class="fl">2</span> <span class="op">/</span> <span class="va">N</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">ZDb</span> <span class="op">=</span> <span class="op">(</span><span class="va">Db</span> <span class="op">-</span> <span class="va">NEDb</span><span class="op">)</span><span class="op">/</span> <span class="va">DPDb</span> 
<span class="va">pvalue</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">ZDb</span><span class="op">)</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span>
<span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">ZDb</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="fl">1.64</span>, 
<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"aggregation or clustering"</span><span class="op">)</span>, 
<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"randomness"</span><span class="op">)</span><span class="op">)</span> 
<span class="co"># Print the results</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"There are"</span>,<span class="va">Db</span>,<span class="st">"doublets in the sequence. The number of expected doublets is"</span>,<span class="va">NEDb</span>,<span class="st">"."</span>,<span class="st">"The value of Z is"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">ZDb</span>,<span class="fl">3</span><span class="op">)</span>, <span class="st">"indicating "</span>, <span class="va">result</span>,<span class="st">". P-value:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">pvalue</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Run the function calling the vector</span>
<span class="fu">doublets.test</span><span class="op">(</span><span class="va">row1</span><span class="op">$</span><span class="va">y1</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "There are 4 doublets in the sequence. The number of expected doublets is 2.8 . The value of Z is 0.756 indicating  randomness . P-value: 0.4497"</code></pre>
</div>
<div id="joint-count" class="section level3" number="4.2.3">
<h3>
<span class="header-section-number">4.2.3</span> Joint count<a class="anchor" aria-label="anchor" href="#joint-count"><i class="fas fa-link"></i></a>
</h3>
<p>Joint count statistics. Description.</p>
<div class="inline-figure"><img src="imgs/spatial_jointcount.png" style="width:100.0%"></div>
<p>Let’s use the <code>join.count</code> function of the <code>spdep</code> package to perform a joint count test.</p>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Enter the data</span>
<span class="va">S2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0</span>,
       <span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,
       <span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,
       <span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">1</span>,
       <span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>
 
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span> <span class="op">(</span><span class="va"><a href="https://github.com/r-spatial/spdep/">spdep</a></span><span class="op">)</span>
<span class="va">nb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/spdep/man/cell2nb.html">cell2nb</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">5</span>, 
              type<span class="op">=</span><span class="st">"rook"</span>, 
              torus<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="va">jc_rook</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/spdep/man/joincount.test.html">joincount.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">S2</span><span class="op">)</span>, 
                          <span class="fu"><a href="https://rdrr.io/pkg/spdep/man/nb2listw.html">nb2listw</a></span><span class="op">(</span><span class="va">nb</span>, 
                                   style<span class="op">=</span><span class="st">"B"</span><span class="op">)</span><span class="op">)</span>
<span class="va">jc_rook</span></code></pre></div>
<pre><code>## 
##  Join count test under nonfree sampling
## 
## data:  factor(S2) 
## weights: nb2listw(nb, style = "B") 
## 
## Std. deviate for 0 = -0.2, p-value = 0.6
## alternative hypothesis: greater
## sample estimates:
## Same colour statistic           Expectation              Variance 
##                 10.00                 10.40                  3.17 
## 
## 
##  Join count test under nonfree sampling
## 
## data:  factor(S2) 
## weights: nb2listw(nb, style = "B") 
## 
## Std. deviate for 1 = -1, p-value = 0.8
## alternative hypothesis: greater
## sample estimates:
## Same colour statistic           Expectation              Variance 
##                  7.00                  8.80                  3.03</code></pre>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#joincount.mc(factor(S2), nb2listw(nb, style="B"), nsim = 1000)</span></code></pre></div>
</div>
</div>
<div id="real-examples" class="section level2" number="4.3">
<h2>
<span class="header-section-number">4.3</span> Real examples<a class="anchor" aria-label="anchor" href="#real-examples"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://epiphy.org">epiphy</a></span><span class="op">)</span>
<span class="va">series</span> <span class="op">&lt;-</span> <span class="va">citrus_ctv</span><span class="op">$</span><span class="va">IVI3and4</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">t</span> <span class="op">==</span> <span class="fl">1991</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">pull</span><span class="op">(</span><span class="va">i</span><span class="op">)</span>

<span class="fu">oruns.test</span><span class="op">(</span><span class="va">series</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "There are 54 runs in the sequence. The number of expected runs is 71.1 . The value of Z is -3.598 indicating  clustering . P-value: 0.00032"</code></pre>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/randtests/man/runs.test.html">runs.test</a></span><span class="op">(</span><span class="va">series</span>, threshold <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></code></pre></div>
<pre><code>## 
##  Runs Test
## 
## data:  series
## statistic = -4, runs = 54, n1 = 44, n2 = 172, n = 216, p-value = 3e-04
## alternative hypothesis: nonrandomness</code></pre>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">doublets.test</span><span class="op">(</span><span class="va">series</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "There are 17 doublets in the sequence. The number of expected doublets is 8.75925925925926 . The value of Z is 2.797 indicating  aggregation or clustering . P-value: 0.0052"</code></pre>

<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-chapter2017b" class="csl-entry">
Madden, Laurence V., Gareth Hughes, and Frank van den Bosch, eds. 2017a. <span>“CHAPTER 4: Temporal Analysis i: Quantifying and Comparing Epidemics.”</span> In, 63–116. The American Phytopathological Society. <a href="https://doi.org/10.1094/9780890545058.004">https://doi.org/10.1094/9780890545058.004</a>.
</div>
<div id="ref-chapter2017" class="csl-entry">
———, eds. 2017b. <span>“CHAPTER 9: Spatial Aspects of Epidemics<span></span>III: Patterns of Plant Disease.”</span> In, 235–78. The American Phytopathological Society. <a href="https://doi.org/10.1094/9780890545058.009">https://doi.org/10.1094/9780890545058.009</a>.
</div>
</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="spatial-gradients.html"><span class="header-section-number">3</span> Spatial gradients</a></div>
<div class="empty"></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#spatial-patterns"><span class="header-section-number">4</span> Spatial patterns</a></li>
<li><a class="nav-link" href="#introduction"><span class="header-section-number">4.1</span> Introduction</a></li>
<li>
<a class="nav-link" href="#position-and-status-within-a-row-plant-to-plant"><span class="header-section-number">4.2</span> Position and status within a row (plant to plant)</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#runs-test"><span class="header-section-number">4.2.1</span> Runs test</a></li>
<li><a class="nav-link" href="#doublets"><span class="header-section-number">4.2.2</span> Doublets</a></li>
<li><a class="nav-link" href="#joint-count"><span class="header-section-number">4.2.3</span> Joint count</a></li>
</ul>
</li>
<li><a class="nav-link" href="#real-examples"><span class="header-section-number">4.3</span> Real examples</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>R4PDE</strong>" was written by Emerson M. Del Ponte. It was last built on 2022-04-21.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
