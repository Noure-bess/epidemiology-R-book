<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 5 Non-replicated epidemics | Temporal analysis: Model fitting 2</title>
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.9/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.5.1/tabs.js"></script><script src="libs/bs3compat-0.2.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS -->
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Temporal analysis: Model fitting 2</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Welcome</a></li>
<li><a class="" href="temporal-analysis.html"><span class="header-section-number">2</span> Temporal analysis</a></li>
<li><a class="" href="spatial-gradients.html"><span class="header-section-number">3</span> Spatial gradients</a></li>
<li><a class="" href="temporal-analysis-1.html"><span class="header-section-number">4</span> Temporal analysis</a></li>
<li><a class="active" href="non-replicated-epidemics.html"><span class="header-section-number">5</span> Non-replicated epidemics</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="non-replicated-epidemics" class="section level1" number="5">
<h1>
<span class="header-section-number">5</span> Non-replicated epidemics<a class="anchor" aria-label="anchor" href="#non-replicated-epidemics"><i class="fas fa-link"></i></a>
</h1>
<p>Here we will compare three DPCs of the incidence of tobacco etch, a virus disease, in peppers. Evaluations of incidence were evaluated at a 7-day interval up to 49 days. The data are available in chapter 4 (page 93) <span class="citation">(<a href="#ref-madden2017" role="doc-biblioref"><strong>madden2017?</strong></a>)</span>. Let’s input the data manually and create a data frame. First column is the assessment time and the other columns correspond to the treatments, called groups in the book, from 1 to 3.</p>
<div id="initial-setup-1" class="section level2" number="5.1">
<h2>
<span class="header-section-number">5.1</span> Initial setup<a class="anchor" aria-label="anchor" href="#initial-setup-1"><i class="fas fa-link"></i></a>
</h2>
<p>Load essential packages and set parameters recursively.</p>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/">knitr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jrnold/ggthemes">ggthemes</a></span><span class="op">)</span>
<span class="fu">theme_set</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/theme_few.html">theme_few</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="fu">knitr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/knitr/man/opts_chunk.html">opts_chunk</a></span><span class="op">$</span><span class="fu">set</span><span class="op">(</span>echo <span class="op">=</span> <span class="cn">TRUE</span>, warning <span class="op">=</span> <span class="cn">FALSE</span>, message <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></code></pre></div>
</div>
<div id="entering-data-1" class="section level2" number="5.2">
<h2>
<span class="header-section-number">5.2</span> Entering data<a class="anchor" aria-label="anchor" href="#entering-data-1"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pepper</span> <span class="op">&lt;-</span>
  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html">tribble</a></span><span class="op">(</span>
    <span class="op">~</span><span class="va">t</span>, <span class="op">~</span><span class="va">`1`</span>, <span class="op">~</span><span class="va">`2`</span>, <span class="op">~</span><span class="va">`3`</span>,
    <span class="fl">0</span>, <span class="fl">0.08</span>, <span class="fl">0.001</span>, <span class="fl">0.001</span>,
    <span class="fl">7</span>, <span class="fl">0.13</span>, <span class="fl">0.01</span>, <span class="fl">0.001</span>,
    <span class="fl">14</span>, <span class="fl">0.78</span>, <span class="fl">0.09</span>, <span class="fl">0.01</span>,
    <span class="fl">21</span>, <span class="fl">0.92</span>, <span class="fl">0.25</span>, <span class="fl">0.05</span>,
    <span class="fl">28</span>, <span class="fl">0.99</span>, <span class="fl">0.8</span>, <span class="fl">0.18</span>,
    <span class="fl">35</span>, <span class="fl">0.995</span>, <span class="fl">0.98</span>, <span class="fl">0.34</span>,
    <span class="fl">42</span>, <span class="fl">0.999</span>, <span class="fl">0.99</span>, <span class="fl">0.48</span>,
    <span class="fl">49</span>, <span class="fl">0.999</span>, <span class="fl">0.999</span>, <span class="fl">0.74</span>
  <span class="op">)</span></code></pre></div>
</div>
<div id="visualize-the-dpcs-1" class="section level2" number="5.3">
<h2>
<span class="header-section-number">5.3</span> Visualize the DPCs<a class="anchor" aria-label="anchor" href="#visualize-the-dpcs-1"><i class="fas fa-link"></i></a>
</h2>
<p>Before proceeding with model selection and fitting, let’s visualize the three epidemics. The code below reproduces quite exactly the top plot of Fig. 4.15 (<span class="citation">(<a href="non-replicated-epidemics.html#ref-chapter2017b" role="doc-biblioref">Madden, Hughes, and van den Bosch 2017</a>)</span> page 94). The appraisal of the curves might give us a hint on which models are the best candidates.</p>
<p>Because the data was entered in the wide format (each DPCs in a different columns) we need to reshape it to the tidyverse-suitable format, which is the long format. The <code>pivot_longer</code> function will do the job of reshaping from wide to long format so we can finally use the <code>ggplot</code> function to produce the plot.</p>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pepper</span> <span class="op">%&gt;%</span>
  <span class="fu">pivot_longer</span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">4</span>, names_to <span class="op">=</span> <span class="st">"treat"</span>, values_to <span class="op">=</span> <span class="st">"inc"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">t</span>, <span class="va">inc</span>,
    linetype <span class="op">=</span> <span class="va">treat</span>,
    shape <span class="op">=</span> <span class="va">treat</span>,
    group <span class="op">=</span> <span class="va">treat</span>
  <span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">annotate</span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">15</span>, y <span class="op">=</span> <span class="fl">0.84</span>, label <span class="op">=</span> <span class="st">"1"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">annotate</span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">23</span>, y <span class="op">=</span> <span class="fl">0.6</span>, label <span class="op">=</span> <span class="st">"2"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">annotate</span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">32</span>, y <span class="op">=</span> <span class="fl">0.33</span>, label <span class="op">=</span> <span class="st">"3"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>
    y <span class="op">=</span> <span class="st">"Disease incidence (y)"</span>,
    x <span class="op">=</span> <span class="st">"Time (days)"</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="livro_files/figure-html/unnamed-chunk-63-1.png" width="672"></div>
<p>Most of the three curves show a sigmoid shape with the exception of group 3 that resembles an exponential growth, not reaching the maximum value, and thus suggesting an incomplete epidemic. We can easily eliminate the monomolecular and exponential models and decide on the other two non-flexible models: logistic or Gompertz. To do that, let’s proceed to model fitting and evaluate the statistics for supporting a final decision. There are two modeling approaches for model fitting in epifitter: the <strong>linear</strong> or <strong>nonlinear</strong> parameter-estimation methods.</p>
</div>
<div id="fitting-single-epidemics-1" class="section level2" number="5.4">
<h2>
<span class="header-section-number">5.4</span> Fitting: single epidemics<a class="anchor" aria-label="anchor" href="#fitting-single-epidemics-1"><i class="fas fa-link"></i></a>
</h2>
<p>Among the several options offered by <em>epifitter</em> we start with the simplest one, which is fit a model to a single epidemics using the linear regression approach. For such, the <code><a href="https://rdrr.io/pkg/epifitter/man/fit_lin.html">fit_lin()</a></code> requires two arguments: time (<code>time</code>) and disease intensity (<code>y</code>) each one as a vector stored or not in a dataframe.</p>
<p>Since we have three epidemics, <code><a href="https://rdrr.io/pkg/epifitter/man/fit_lin.html">fit_lin()</a></code> will be use three times. The function produces a list object with six elements. Let’s first look at the <code>Stats</code> dataframe of each of the three lists named <code>epi1</code> to <code>epi3</code>.</p>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/AlvesKS/epifitter">epifitter</a></span><span class="op">)</span>

<span class="va">epi1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/epifitter/man/fit_lin.html">fit_lin</a></span><span class="op">(</span>
  time <span class="op">=</span> <span class="va">pepper</span><span class="op">$</span><span class="va">t</span>,
  y <span class="op">=</span> <span class="va">pepper</span><span class="op">$</span><span class="va">`1`</span>
<span class="op">)</span>
<span class="va">epi1</span><span class="op">$</span><span class="va">Stats</span></code></pre></div>
<pre><code>##                 CCC r_squared   RSE
## Gompertz      0.985     0.970 0.591
## Monomolecular 0.984     0.968 0.543
## Logistic      0.978     0.957 0.824
## Exponential   0.784     0.645 0.670</code></pre>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">epi2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/epifitter/man/fit_lin.html">fit_lin</a></span><span class="op">(</span>
  time <span class="op">=</span> <span class="va">pepper</span><span class="op">$</span><span class="va">t</span>,
  y <span class="op">=</span> <span class="va">pepper</span><span class="op">$</span><span class="va">`2`</span>
<span class="op">)</span>
<span class="va">epi2</span><span class="op">$</span><span class="va">Stats</span></code></pre></div>
<pre><code>##                 CCC r_squared   RSE
## Logistic      0.996     0.992 0.452
## Gompertz      0.971     0.943 0.841
## Monomolecular 0.925     0.860 1.068
## Exponential   0.897     0.813 1.202</code></pre>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">epi3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/epifitter/man/fit_lin.html">fit_lin</a></span><span class="op">(</span>
  time <span class="op">=</span> <span class="va">pepper</span><span class="op">$</span><span class="va">t</span>,
  y <span class="op">=</span> <span class="va">pepper</span><span class="op">$</span><span class="va">`3`</span>
<span class="op">)</span>
<span class="va">epi3</span><span class="op">$</span><span class="va">Stats</span></code></pre></div>
<pre><code>##                 CCC r_squared   RSE
## Logistic      0.983     0.967 0.605
## Gompertz      0.983     0.966 0.226
## Exponential   0.964     0.930 0.771
## Monomolecular 0.859     0.753 0.253</code></pre>
<p>The statistics of the model fit confirms our initial guess that the predictions by the logistic or the Gompertz are closer to the observations than predictions by the other models. There is no much difference between them based on these statistics. However, to pick one of the models, it is important to inspect the curves with the observed and predicted values to check which model is best for all curves.</p>
</div>
<div id="fitting-multiple-epidemics-1" class="section level2" number="5.5">
<h2>
<span class="header-section-number">5.5</span> Fitting: multiple epidemics<a class="anchor" aria-label="anchor" href="#fitting-multiple-epidemics-1"><i class="fas fa-link"></i></a>
</h2>
<p>Before looking at the prediction, let’s use another handy function that allows us to simultaneously fit the models to multiple DPC data. Different from <code><a href="https://rdrr.io/pkg/epifitter/man/fit_lin.html">fit_lin()</a></code>, <code><a href="https://rdrr.io/pkg/epifitter/man/fit_multi.html">fit_multi()</a></code> requires the data to be structured in the long format where there is a column specifying each of the epidemics.</p>
<p>Let’s then create a new data set called <code>pepper2</code> using the data transposing functions of the <em>tidyr</em> package.</p>
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pepper2</span> <span class="op">&lt;-</span> <span class="va">pepper</span> <span class="op">%&gt;%</span>
  <span class="fu">pivot_longer</span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">4</span>, names_to <span class="op">=</span> <span class="st">"treat"</span>, values_to <span class="op">=</span> <span class="st">"inc"</span><span class="op">)</span></code></pre></div>
<p>Now we fit the models to all DPCs. Note that the name of the variable indicating the DPC code needs to be informed in <code>strata_cols</code> argument.</p>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">epi_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/epifitter/man/fit_multi.html">fit_multi</a></span><span class="op">(</span>
  time_col <span class="op">=</span> <span class="st">"t"</span>,
  intensity_col <span class="op">=</span> <span class="st">"inc"</span>,
  data <span class="op">=</span> <span class="va">pepper2</span>,
  strata_cols <span class="op">=</span> <span class="st">"treat"</span>,
  nlin <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span></code></pre></div>
<p>Now let’s select the statistics of model fitting. Again, <em>Epifitter</em> ranks the models based on the CCC (the higher the better) but it is important to check the RSE as well - the lower the better. In fact, the RSE is more important when the goal is prediction.</p>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">epi_all</span><span class="op">$</span><span class="va">Parameters</span> <span class="op">%&gt;%</span>
  <span class="fu">select</span><span class="op">(</span><span class="va">treat</span>, <span class="va">model</span>, <span class="va">best_model</span>, <span class="va">RSE</span>, <span class="va">CCC</span><span class="op">)</span></code></pre></div>
<pre><code>##    treat         model best_model   RSE   CCC
## 1      1      Gompertz          1 0.591 0.985
## 2      1 Monomolecular          2 0.543 0.984
## 3      1      Logistic          3 0.824 0.978
## 4      1   Exponential          4 0.671 0.784
## 5      2      Logistic          1 0.452 0.996
## 6      2      Gompertz          2 0.841 0.971
## 7      2 Monomolecular          3 1.068 0.925
## 8      2   Exponential          4 1.202 0.897
## 9      3      Logistic          1 0.605 0.983
## 10     3      Gompertz          2 0.226 0.982
## 11     3   Exponential          3 0.771 0.964
## 12     3 Monomolecular          4 0.253 0.859</code></pre>
<p>To be more certain about our decision, let’s advance to the final step which is to produce the plots with the observed and predicted values for each assessment time by calling the <code>Data</code> dataframe of the `<code>epi_all</code> list.</p>
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">epi_all</span><span class="op">$</span><span class="va">Data</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">model</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Gompertz"</span>, <span class="st">"Logistic"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">time</span>, <span class="va">predicted</span>, shape <span class="op">=</span> <span class="va">treat</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">time</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">model</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">coord_cartesian</span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="co"># set the max to 0.6</span>
  <span class="fu">labs</span><span class="op">(</span>
    y <span class="op">=</span> <span class="st">"Disease incidence"</span>,
    x <span class="op">=</span> <span class="st">"Time (days after emergence)"</span>
  <span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="livro_files/figure-html/unnamed-chunk-70-1.png" width="672"></div>
<p>Overall, the logistic model seems a better fit for all the curves. Let’s produce a plot with the prediction error versus time.</p>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">epi_all</span><span class="op">$</span><span class="va">Data</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">model</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Gompertz"</span>, <span class="st">"Logistic"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">time</span>, <span class="va">predicted</span> <span class="op">-</span> <span class="va">y</span>, shape <span class="op">=</span> <span class="va">treat</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">model</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">coord_cartesian</span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.4</span>, <span class="fl">0.4</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="co"># set the max to 0.6</span>
  <span class="fu">labs</span><span class="op">(</span>
    y <span class="op">=</span> <span class="st">"Prediction error"</span>,
    x <span class="op">=</span> <span class="st">"Time (days after emergence)"</span>
  <span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="livro_files/figure-html/unnamed-chunk-71-1.png" width="672"></div>
<p>The plots above confirms the logistic model as good fit overall because the errors for all epidemics combined are more scattered around the non-error line.</p>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">epi_all</span><span class="op">$</span><span class="va">Parameters</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">model</span> <span class="op">==</span> <span class="st">"Logistic"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">select</span><span class="op">(</span><span class="va">treat</span>, <span class="va">y0</span>, <span class="va">y0_ci_lwr</span>, <span class="va">y0_ci_upr</span>, <span class="va">r</span>, <span class="va">r_ci_lwr</span>, <span class="va">r_ci_upr</span><span class="op">)</span></code></pre></div>
<pre><code>##   treat       y0 y0_ci_lwr y0_ci_upr     r r_ci_lwr r_ci_upr
## 1     1 0.093504  0.027321   0.27473 0.210    0.166    0.255
## 2     2 0.001373  0.000672   0.00280 0.278    0.254    0.303
## 3     3 0.000813  0.000313   0.00211 0.175    0.143    0.208</code></pre>
<p>We can produce a plot for visual inference on the differences in the parameters.</p>
<div class="sourceCode" id="cb92"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p1</span> <span class="op">&lt;-</span> <span class="va">epi_all</span><span class="op">$</span><span class="va">Parameters</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">model</span> <span class="op">==</span> <span class="st">"Logistic"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">treat</span>, <span class="va">r</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_errorbar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">r_ci_lwr</span>, ymax <span class="op">=</span> <span class="va">r_ci_upr</span><span class="op">)</span>,
    width <span class="op">=</span> <span class="fl">0</span>,
    size <span class="op">=</span> <span class="fl">1</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>
    x <span class="op">=</span> <span class="st">"Time"</span>,
    y <span class="op">=</span> <span class="st">"r"</span>
  <span class="op">)</span>

<span class="va">p2</span> <span class="op">&lt;-</span> <span class="va">epi_all</span><span class="op">$</span><span class="va">Parameters</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">model</span> <span class="op">==</span> <span class="st">"Logistic"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">treat</span>, <span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">y0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_errorbar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">y0_ci_lwr</span>, ymax <span class="op">=</span> <span class="va">y0_ci_upr</span><span class="op">)</span>,
    width <span class="op">=</span> <span class="fl">0</span>,
    size <span class="op">=</span> <span class="fl">1</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>
    x <span class="op">=</span> <span class="st">"Time"</span>,
    y <span class="op">=</span> <span class="st">"y0"</span>
  <span class="op">)</span>

<span class="va">p1</span> <span class="op">|</span> <span class="va">p2</span></code></pre></div>
<div class="inline-figure"><img src="livro_files/figure-html/unnamed-chunk-73-1.png" width="672"></div>

<p>In this next exercise, we will work with disease data collected over time in the same plot unit (also called repeated measures) from a designed experiment for evaluating and comparing treatment effects.</p>
<p>Again, we will use a dataset of progress curves shown in page 98 <span class="citation">(<a href="#ref-chapter2017f" role="doc-biblioref"><strong>chapter2017f?</strong></a>)</span>. The curves represent the incidence of soybean plants symptomatic for bud blight caused by tobacco streak virus. Four treatments (different planting dates) were evaluated in randomized complete block design with four replicates. There are four assessment in time for each curve. The data was stored as a csv file and will be loaded using <code>read_csv()</code> function and stored as dataframe called <code>budblight</code>.</p>
<div id="loading-data-1" class="section level4" number="5.5.0.1">
<h4>
<span class="header-section-number">5.5.0.1</span> Loading data<a class="anchor" aria-label="anchor" href="#loading-data-1"><i class="fas fa-link"></i></a>
</h4>
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="va">budblight</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"data/bud-blight-soybean.csv"</span><span class="op">)</span></code></pre></div>
<p>Let’s have a look at the first six rows of the dataset and check the data type for each column. There is an additional column representing the replicates, called block.</p>
<div class="sourceCode" id="cb94"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">budblight</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   treat  time block     y
##   &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 PD1      30     1  0.1 
## 2 PD1      30     2  0.3 
## 3 PD1      30     3  0.1 
## 4 PD1      30     4  0.1 
## 5 PD1      40     1  0.3 
## 6 PD1      40     2  0.38</code></pre>
</div>
<div id="visualizing-the-dpcs-1" class="section level4" number="5.5.0.2">
<h4>
<span class="header-section-number">5.5.0.2</span> Visualizing the DPCs<a class="anchor" aria-label="anchor" href="#visualizing-the-dpcs-1"><i class="fas fa-link"></i></a>
</h4>
<p>Let’s have a look at the curves and produce a combo plot figure similar to Fig. 4.17 of the book, but without the line of the predicted values.</p>
<div class="sourceCode" id="cb96"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p3</span> <span class="op">&lt;-</span> <span class="va">budblight</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>
    <span class="va">time</span>, <span class="va">y</span>,
    group <span class="op">=</span> <span class="va">block</span>,
    shape <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">block</span><span class="op">)</span>
  <span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">ylim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.6</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">treat</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>
    y <span class="op">=</span> <span class="st">"Disease incidence"</span>,
    x <span class="op">=</span> <span class="st">"Time (days after emergence)"</span>
  <span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p4</span> <span class="op">&lt;-</span> <span class="va">budblight</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>
    <span class="va">time</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span>,
    group <span class="op">=</span> <span class="va">block</span>,
    shape <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">block</span><span class="op">)</span>
  <span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">treat</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Transformed incidence"</span>, x <span class="op">=</span> <span class="st">"Time (days after emergence)"</span><span class="op">)</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span>
<span class="va">p3</span> <span class="op">|</span> <span class="va">p4</span></code></pre></div>
<div class="inline-figure"><img src="livro_files/figure-html/unnamed-chunk-77-1.png" width="672"></div>
</div>
<div id="model-fitting-3" class="section level4" number="5.5.0.3">
<h4>
<span class="header-section-number">5.5.0.3</span> Model fitting<a class="anchor" aria-label="anchor" href="#model-fitting-3"><i class="fas fa-link"></i></a>
</h4>
<p>Remember that the first step in model selection is the visual appraisal of the curve data linearized with the model transformation. In the case the curves represent complete epidemics (close to 100%) appraisal of the absolute rate (difference in y between two times) over time is also helpful.</p>
<p>For the treatments above, it looks like the curves are typical of a monocyclic disease (the case of soybean bud blight), for which the monomolecular is usually a good fit, but other models are also possible as well. For this exercise, we will use both the linear and the nonlinear estimation method.</p>
<div id="linear-regression-2" class="section level5" number="5.5.0.3.1">
<h5>
<span class="header-section-number">5.5.0.3.1</span> Linear regression<a class="anchor" aria-label="anchor" href="#linear-regression-2"><i class="fas fa-link"></i></a>
</h5>
<p>For convenience, we use the <code><a href="https://rdrr.io/pkg/epifitter/man/fit_multi.html">fit_multi()</a></code> to handle multiple epidemics. The function returns a list object where a series of statistics are provided to aid in model selection and parameter estimation. We need to provide the names of columns (arguments): assessment time (<code>time_col</code>), disease incidence (<code>intensity_col</code>), and treatment (<code>strata_cols</code>).</p>
<div class="sourceCode" id="cb98"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/AlvesKS/epifitter">epifitter</a></span><span class="op">)</span>
<span class="va">lin1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/epifitter/man/fit_multi.html">fit_multi</a></span><span class="op">(</span>
  time_col <span class="op">=</span> <span class="st">"time"</span>,
  intensity_col <span class="op">=</span> <span class="st">"y"</span>,
  data <span class="op">=</span> <span class="va">budblight</span>,
  strata_cols <span class="op">=</span> <span class="st">"treat"</span>,
  nlin <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span></code></pre></div>
<p>Let’s look at how well the four models fitted the data. Epifitter suggests the best fitted model (1 to 4, where 1 is best) for each treatment. Let’s have a look at the statistics of model fitting.</p>
<div class="sourceCode" id="cb99"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lin1</span><span class="op">$</span><span class="va">Parameters</span> <span class="op">%&gt;%</span>
  <span class="fu">select</span><span class="op">(</span><span class="va">treat</span>, <span class="va">best_model</span>, <span class="va">model</span>, <span class="va">CCC</span>, <span class="va">RSE</span><span class="op">)</span></code></pre></div>
<pre><code>##    treat best_model         model   CCC    RSE
## 1    PD1          1 Monomolecular 0.935 0.0981
## 2    PD1          2      Gompertz 0.904 0.2223
## 3    PD1          3      Logistic 0.871 0.4475
## 4    PD1          4   Exponential 0.828 0.3612
## 5    PD2          1 Monomolecular 0.955 0.0700
## 6    PD2          2      Gompertz 0.931 0.1794
## 7    PD2          3      Logistic 0.906 0.3877
## 8    PD2          4   Exponential 0.880 0.3268
## 9    PD3          1 Monomolecular 0.939 0.0683
## 10   PD3          2      Gompertz 0.929 0.1716
## 11   PD3          3      Logistic 0.909 0.3905
## 12   PD3          4   Exponential 0.890 0.3388
## 13   PD4          1      Gompertz 0.923 0.1747
## 14   PD4          2 Monomolecular 0.895 0.0649
## 15   PD4          3      Logistic 0.891 0.5241
## 16   PD4          4   Exponential 0.874 0.4977</code></pre>
<p>And now we extract values for each parameter estimated from the fit of the monomolecular model.</p>
<div class="sourceCode" id="cb101"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lin1</span><span class="op">$</span><span class="va">Parameters</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">model</span> <span class="op">==</span> <span class="st">"Monomolecular"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">select</span><span class="op">(</span><span class="va">treat</span>, <span class="va">y0</span>, <span class="va">r</span><span class="op">)</span></code></pre></div>
<pre><code>##   treat     y0      r
## 1   PD1 -0.573 0.0220
## 2   PD2 -0.522 0.0190
## 3   PD3 -0.449 0.0159
## 4   PD4 -0.362 0.0112</code></pre>
<p>Now we visualize the fit of the monomolecular model (using <code>filter</code> function - see below) to the data together with the observed data and then reproduce the right plots in Fig. 4.17 from the book.</p>
<div class="sourceCode" id="cb103"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lin1</span><span class="op">$</span><span class="va">Data</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">model</span> <span class="op">==</span> <span class="st">"Monomolecular"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">time</span>, <span class="va">predicted</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">time</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">treat</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">coord_cartesian</span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.6</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="co"># set the max to 0.6</span>
  <span class="fu">labs</span><span class="op">(</span>
    y <span class="op">=</span> <span class="st">"Disease incidence"</span>,
    x <span class="op">=</span> <span class="st">"Time (days after emergence)"</span>
  <span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="livro_files/figure-html/unnamed-chunk-81-1.png" width="672"></div>
<p>Now we can plot the means and respective 95% confidence interval of the apparent infection rate (<span class="math inline">\(r\)</span>) and initial inoculum (<span class="math inline">\(y_0\)</span>) for visual inference.</p>
<div class="sourceCode" id="cb104"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p5</span> <span class="op">&lt;-</span> <span class="va">lin1</span><span class="op">$</span><span class="va">Parameters</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">model</span> <span class="op">==</span> <span class="st">"Monomolecular"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">treat</span>, <span class="va">r</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_errorbar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">r_ci_lwr</span>, ymax <span class="op">=</span> <span class="va">r_ci_upr</span><span class="op">)</span>,
    width <span class="op">=</span> <span class="fl">0</span>,
    size <span class="op">=</span> <span class="fl">1</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>
    x <span class="op">=</span> <span class="st">"Time"</span>,
    y <span class="op">=</span> <span class="st">"r"</span>
  <span class="op">)</span>

<span class="va">p6</span> <span class="op">&lt;-</span> <span class="va">lin1</span><span class="op">$</span><span class="va">Parameters</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">model</span> <span class="op">==</span> <span class="st">"Monomolecular"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">treat</span>, <span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">y0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_errorbar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">y0_ci_lwr</span>, ymax <span class="op">=</span> <span class="va">y0_ci_upr</span><span class="op">)</span>,
    width <span class="op">=</span> <span class="fl">0</span>,
    size <span class="op">=</span> <span class="fl">1</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>
    x <span class="op">=</span> <span class="st">"Time"</span>,
    y <span class="op">=</span> <span class="st">"y0"</span>
  <span class="op">)</span>

<span class="va">p5</span></code></pre></div>
<div class="inline-figure"><img src="livro_files/figure-html/unnamed-chunk-82-1.png" width="672"></div>
</div>
<div id="non-linear-regression-1" class="section level5" number="5.5.0.3.2">
<h5>
<span class="header-section-number">5.5.0.3.2</span> Non-linear regression<a class="anchor" aria-label="anchor" href="#non-linear-regression-1"><i class="fas fa-link"></i></a>
</h5>
<p>To estimate the parameters using the non-linear approach, we repeat the same arguments in the <code>fit_multi</code> function, but include an additional argument <code>nlin</code> set to <code>TRUE</code>.</p>
<div class="sourceCode" id="cb105"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nlin1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/epifitter/man/fit_multi.html">fit_multi</a></span><span class="op">(</span>
  time_col <span class="op">=</span> <span class="st">"time"</span>,
  intensity_col <span class="op">=</span> <span class="st">"y"</span>,
  data <span class="op">=</span> <span class="va">budblight</span>,
  strata_cols <span class="op">=</span> <span class="st">"treat"</span>,
  nlin <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span></code></pre></div>
<p>Let’s check statistics of model fit.</p>
<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nlin1</span><span class="op">$</span><span class="va">Parameters</span> <span class="op">%&gt;%</span>
  <span class="fu">select</span><span class="op">(</span><span class="va">treat</span>, <span class="va">model</span>, <span class="va">CCC</span>, <span class="va">RSE</span>, <span class="va">best_model</span><span class="op">)</span></code></pre></div>
<pre><code>##    treat         model   CCC    RSE best_model
## 1    PD1 Monomolecular 0.938 0.0613          1
## 2    PD1      Gompertz 0.917 0.0699          2
## 3    PD1      Logistic 0.896 0.0770          3
## 4    PD1   Exponential 0.854 0.0880          4
## 5    PD2 Monomolecular 0.967 0.0421          1
## 6    PD2      Gompertz 0.935 0.0573          2
## 7    PD2      Logistic 0.908 0.0666          3
## 8    PD2   Exponential 0.870 0.0767          4
## 9    PD3 Monomolecular 0.957 0.0427          1
## 10   PD3      Gompertz 0.926 0.0544          2
## 11   PD3      Logistic 0.900 0.0620          3
## 12   PD3   Exponential 0.870 0.0689          4
## 13   PD4 Monomolecular 0.918 0.0460          1
## 14   PD4      Gompertz 0.909 0.0479          2
## 15   PD4      Logistic 0.894 0.0508          3
## 16   PD4   Exponential 0.884 0.0527          4</code></pre>
<p>And now we obtain the two parameters of interest. Note that the values are not the sames as those estimated using linear regression, but they are similar and highly correlated.</p>
<div class="sourceCode" id="cb108"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nlin1</span><span class="op">$</span><span class="va">Parameters</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">model</span> <span class="op">==</span> <span class="st">"Monomolecular"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">select</span><span class="op">(</span><span class="va">treat</span>, <span class="va">y0</span>, <span class="va">r</span><span class="op">)</span></code></pre></div>
<pre><code>##   treat     y0      r
## 1   PD1 -0.707 0.0238
## 2   PD2 -0.634 0.0206
## 3   PD3 -0.505 0.0167
## 4   PD4 -0.350 0.0109</code></pre>
<div class="sourceCode" id="cb110"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p7</span> <span class="op">&lt;-</span> <span class="va">nlin1</span><span class="op">$</span><span class="va">Parameters</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">model</span> <span class="op">==</span> <span class="st">"Monomolecular"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">treat</span>, <span class="va">r</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_errorbar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">r_ci_lwr</span>, ymax <span class="op">=</span> <span class="va">r_ci_upr</span><span class="op">)</span>,
    width <span class="op">=</span> <span class="fl">0</span>,
    size <span class="op">=</span> <span class="fl">1</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>
    x <span class="op">=</span> <span class="st">"Time"</span>,
    y <span class="op">=</span> <span class="st">"r"</span>
  <span class="op">)</span>

<span class="va">p8</span> <span class="op">&lt;-</span> <span class="va">nlin1</span><span class="op">$</span><span class="va">Parameters</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">model</span> <span class="op">==</span> <span class="st">"Monomolecular"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">treat</span>, <span class="va">y0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_errorbar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">y0_ci_lwr</span>, ymax <span class="op">=</span> <span class="va">y0_ci_upr</span><span class="op">)</span>,
    width <span class="op">=</span> <span class="fl">0</span>,
    size <span class="op">=</span> <span class="fl">1</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>
    x <span class="op">=</span> <span class="st">"Time"</span>,
    y <span class="op">=</span> <span class="st">"y0"</span>
  <span class="op">)</span>

<span class="va">p7</span> <span class="op">|</span> <span class="va">p8</span></code></pre></div>
<div class="inline-figure"><img src="livro_files/figure-html/unnamed-chunk-86-1.png" width="672"></div>

<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-chapter2017b" class="csl-entry">
Madden, Laurence V., Gareth Hughes, and Frank van den Bosch, eds. 2017. <span>“CHAPTER 4: Temporal Analysis i: Quantifying and Comparing Epidemics.”</span> In, 63–116. The American Phytopathological Society. <a href="https://doi.org/10.1094/9780890545058.004">https://doi.org/10.1094/9780890545058.004</a>.
</div>
</div>
</div>
</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="temporal-analysis-1.html"><span class="header-section-number">4</span> Temporal analysis</a></div>
<div class="empty"></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#non-replicated-epidemics"><span class="header-section-number">5</span> Non-replicated epidemics</a></li>
<li><a class="nav-link" href="#initial-setup-1"><span class="header-section-number">5.1</span> Initial setup</a></li>
<li><a class="nav-link" href="#entering-data-1"><span class="header-section-number">5.2</span> Entering data</a></li>
<li><a class="nav-link" href="#visualize-the-dpcs-1"><span class="header-section-number">5.3</span> Visualize the DPCs</a></li>
<li><a class="nav-link" href="#fitting-single-epidemics-1"><span class="header-section-number">5.4</span> Fitting: single epidemics</a></li>
<li><a class="nav-link" href="#fitting-multiple-epidemics-1"><span class="header-section-number">5.5</span> Fitting: multiple epidemics</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Temporal analysis: Model fitting 2</strong>" was written by true. It was last built on 2021-07-13.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
