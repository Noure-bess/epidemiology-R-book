---
title: "Population dynamics models"
description: |
  Models that summarizes the progress of the epidemics at the population levels
---

# Introduction

The family of models that describe the plant epidemic growth, hence population dynamics model, are known as deterministic models of continuous time. These models usually provide a good fit to disease progress curve data. By convention, time is represented by $t$ , disease intensity is represented by $y$ and the (absolute) rate of change between two time units is represented by $\frac{dy}{dt}$ which depends on $y$ and the apparent infection rate, or $r$, which summarizes the effect of host, pathogen and environment on the "infection chain".

In this tutorial, I will use R to describe the models and create data and simulate the curves so let's firt load essential packages and set some initial parameters for the simulations

```{r echo=TRUE, message=FALSE, warning=FALSE}
library(tidyverse)
library(ggthemes)
library(patchwork)
theme_set(theme_light())
```

```{r echo=TRUE, fig.height=4, fig.width=6}
y0 <- 0.001 # initial inoculum curve 1
r <- 0.06 # rate curve 1
tmax <- 60 # maximum duration t of the epidemics
dat <- data.frame(t = seq(1:tmax), y = seq(0:1))
```

## Models

### Exponential

The differential of the exponential model is given by

$\frac{dy}{dt} = r_E.y$

where $\frac{dy}{dt}$ is the rate (subscript *E* for this model) and $y$ is the disease intensity. Biologically, diseased plants $y$ at each time contribute to the increase of the disease over time $t$. The value of the $\frac{dy}{dt}$ is minimum when $y = 0$ and increases with the increase in $y$.

```{r, echo = T}
dat %>%
  ggplot(aes(t, y)) +
  stat_function(fun = function(t) y0 * exp(r * t)) +
  labs(
    y = "dy/dt",
    x = "Time"
  )
```

The integral is given by $y = y_0 e^{r_Et}$. Let's use R to simulate a few curves by varying the $r$ and $y0$.

```{r echo=TRUE, message=FALSE, warning=FALSE}

p1 <- dat %>%
  ggplot(aes(t, y)) +
  stat_function(fun = function(t) y0 * exp(r * t), linetype = 1) +
  stat_function(fun = function(t) y0 * exp(r * 2 * t), linetype = 2) +
  ylim(0, 1) +
  labs(
    title = "2 times r same y0",
    x = "Time"
  )


p2 <- dat %>%
  ggplot(aes(t, y)) +
  stat_function(fun = function(t) y0 * exp(r * 2 * t), linetype = 1) +
  stat_function(fun = function(t) y0 * 5 * exp(r * 2 * t), linetype = 2) +
  ylim(0, 1) +
  labs(title = "5 times y0 same r", x = "Time")

p1 | p2
```

### Monomolecular

The differential of the monomolecular model is given by

$\frac{dy}{dt} = r_M (1-y)$

where $\frac{y}{dt}$ is the absolute rate, $r_M$ is the rate parameter of the monomolecular model and $(1-y)$ is the proportion of non-infected (healthy) individuals or host tissue. The value of the $\frac{dy}{dt}$ is maximum when $y = 0$ and decreases when $y$ approaches 1. Its decline is due to decrease in the proportion of individuals or healthy sites with the increase in $y$. Any inoculum capable of infecting the host will more likely land on infected individuals or sites. Here is the curve of the absolute rate for the monomolecular model over time.

```{r echo=TRUE, fig.height=4, fig.width=6}
dat %>%
  ggplot(aes(t, y)) +
  stat_function(fun = function(t) y0 * exp(-r * t)) +
  labs(y = "dy/dt", x = "Time")
```

The integral of the model usually describes the temporal patterns of the monocyclic epidemics for which the inoculum produced during the course of the epidemics do not contribute new infections .Therefore, different from the exponential model, disease intensity $y$ do not affect the epidemics and so the absolute rate is proportional to $(1-y)$.

The integral of the monomolecular model is given by

$\frac{dy}{dt} = 1 - (1-y)e^{-r_Mt}$

Let's simulate two monomolecular curves with different rate parameters.

```{r}

p3 <- dat %>%
  ggplot(aes(t, y)) +
  stat_function(fun = function(t) 1 - ((1 - y0) * exp(-r * t))) +
  stat_function(fun = function(t) 1 - ((1 - y0) * exp(-(r / 3) * t))) +
  labs(title = "y0 = 0.001", x = "Time") +
  annotate(geom = "text", x = 35, y = 0.77, label = "r = 0.06") +
  annotate(geom = "text", x = 50, y = 0.55, label = "r = 0.02")

p4 <- dat %>%
  ggplot(aes(t, y)) +
  stat_function(fun = function(t) 1 - ((1 - y0) * exp(-r / 2 * t))) +
  stat_function(fun = function(t) 1 - ((1 - (y0 * 100)) * exp(-r / 2 * t))) +
  labs(title = "r = 0.06", x = "Time") +
  annotate(geom = "text", x = 35, y = 0.77, label = "y0 = 0.01") +
  annotate(geom = "text", x = 45, y = 0.65, label = "y0 = 0.001")

p3 | p4
```

### Logistic

The logistic model is more elaborated than the two previous models as it incorporates the features of them both. Its differential is given by

$\frac{dy}{dt} = ,r_L. y . (1 - y)$

where $r_L$ is the apparent infection rate of the logistic model, $y$ is the proportion of diseased individuals or host tissue and $(1-y)$ is the proportion of non-affected individuals or host area. Biologically, $y$ in its differential equation implies that $\frac{dy}{dt}$ increases with the increase in $y$ (as in the exponential) because more disease leads to more inoculum. However, $(1-y)$ leads to a decrease in $\frac{dy}{dt}$ when $y$ approaches the maximum $y=1$, because the proportion of healthy individuals or host area decreases (as in the monomolecular). Therefore, $\frac{dy}{dt}$ is minimal at the onset of the epidemics, reaches a maximum when $y/2$ and declines until $y=1$.

The integral is given by

$y = \frac{1}{1 + (1-y_0).e^{-r.t}}$,

where $r_L$ is the apparent infection rate of the logistic model and $y0$ is the disease intensity at $t=0$.

```{r}

p5 <- dat %>%
  ggplot(aes(t, y)) +
  stat_function(
    linetype = 2,
    fun = function(t) 1 / (1 + ((1 - y0) / y0) * exp(-r * 2 * t))
  ) +
  stat_function(fun = function(t) 1 / (1 + ((1 - y0) / y0) * exp(-r * 4 * t))) +
  labs(title = "logistic model", subtitle = "y0 = 0.001", x = "Time") +
  annotate(geom = "text", x = 41, y = 0.77, label = "r = 0.18") +
  annotate(geom = "text", x = 50, y = 0.10, label = "r = 0.024")


p6 <- dat %>%
  ggplot(aes(t, y)) +
  stat_function(
    linetype = 2,
    fun = function(t) 1 / (1 + ((1 - (y0 / 10)) / (y0 / 10)) * exp(-r * 3 * t))
  ) +
  stat_function(fun = function(t) 1 / (1 + ((1 - y0) / y0) * exp(-r * 3 * t))) +
  labs(title = "logistic model", subtitle = "r = 0.24", x = "Time") +
  annotate(geom = "text", x = 35, y = 0.77, label = "y0 = 0.001") +
  annotate(geom = "text", x = 50, y = 0.10, label = "y0 = 0.0001")


p5 | p6
```

### Gompertz

Gompertz model is similar to the logistic and provides a very good fit to several polycyclic diseases. The differential equation is given by

$\frac{dy}{dt} = r_G.[ln(1) - ln(y)]$

Differently from the logistic, the variable representing the non-infected individuals or host area is $-ln(y)$. The integral equation is given by

$y = e^{(ln(y0)).{e^{-r_G.t)}}}$

Where $r_G$ is the apparent infection rate for the Gompertz models and $y_0$ is the disease intensity at $t = 0$

```{r}
p7 <- dat %>%
  ggplot(aes(t, y)) +
  stat_function(
    linetype = 2,
    fun = function(t) exp(log(y0) * exp(-r/2 * t))
  ) +
  stat_function(fun = function(t) exp(log(y0) * exp(-r*2 * t))) +
  labs(title = "Gompertz model", subtitle = "y0 = 0.001", x = "Time") +
  annotate(geom = "text", x = 41, y = 0.77, label = "r = 0.12") +
  annotate(geom = "text", x = 50, y = 0.10, label = "r = 0.03")


p8 <- dat %>%
  ggplot(aes(t, y)) +
  stat_function(
    linetype = 2,
    fun = function(t) exp(log(y0) * exp(-r*2 * t))
  ) +
  stat_function(fun = function(t) exp(log(y0/1000) * exp(-r*2 * t))) +
  labs(title = "Gompertz model", subtitle = "r = 0.12", x = "Time") +
  annotate(geom = "text", x = 15, y = 0.77, label = "y0 = 0.001") +
  annotate(geom = "text", x = 25, y = 0.10, label = "y0 = 0.00001")


p7 | p8

```
