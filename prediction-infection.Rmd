---
title: "Untitled"
author: "Emerson"
date: "2022-10-12"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r}

# https://bsppjournals.onlinelibrary.wiley.com/doi/10.1111/j.1365-3059.2006.01393.x
dat3 <- tibble::tribble(
  ~t, ~y,
12.1, 0.0,
15.1, 0.1,
20.0, 0.5,
25.0, 1.2,
30.0, 1.5,
35.0, 1.2,
40.0, 0.1
)



# beta generalizada
# Y=B1((X-B2)^B4)((B3-X)^B5)
fit <- nlsLM(y ~ b1*((x - b2 )^b4)*((b3 - x)^b5),
             start = list(b1 = 0,
                          b2 = 10, 
                          b3 = 40, 
                          b4 = 1.5, 
                          b5 = 1),
             data = dat)
fit$m$getAllPars()


b1 <- fit$m$getAllPars()[1]
b2 <- fit$m$getAllPars()[2]
b3 <- fit$m$getAllPars()[3]
b4 <- fit$m$getAllPars()[4]
b5 <- fit$m$getAllPars()[5]
t <- seq(10,45, 0.1)
y <- b1*((t - b2 )^b4)*((b3 - t)^b5)
dat <- data.frame(t, y)

dat |> 
  ggplot(aes(t, y))+
  geom_line()+
  geom_point(data = dat3, aes(t, y))

```

```{r}
library(digitize)
dat <- digitize("imgs/digitize.png")
dat
```





